angular.module("ecstatic.sockets").factory("socket",["socketFactory","ConfigService","$location",function(e,t,c){return e({ioSocket:io.connect(c.absUrl().split("/")[0]+"//"+c.absUrl().split("/")[2],{path:"/api/socket.io"})})}]).factory("socketManager",["$q","$rootScope","socket","$location",function(e,t,c,o){function a(){return i+=1,i>1e4&&(i=0),i}var r={},n={},i=0;return r.sendRequest=function(t){var o=e.defer(),r=a();return n[r]={time:new Date,cb:o},t.callback_id=r,c.emit(t.msg,t),o.promise},r.listener=function(e){var c=e;n.hasOwnProperty(c.callback_id)&&(t.$apply(n[c.callback_id].cb.resolve(c)),delete n[c.callbackID])},r}]);