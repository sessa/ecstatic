angular.module("ecstatic.soundcloud").factory("soundcloudService",["$q","$rootScope","ConfigService","$location","$localStorage",function(e,n,o,c,i){var t={},s=e.defer();return t.getFavorites=function(){var e=c.absUrl().split("/")[0]+"//"+c.absUrl().split("/")[2]+"/soundcloud/callback";return SC.accessToken()&&(i.accessToken=SC.accessToken()),o.getConfig().then(function(o){i.accessToken?(SC.initialize({client_id:i.soundcloudClientId,redirect_uri:e,access_token:i.accessToken,scope:"non-expiring"}),SC.get("/me",function(e){SC.get("/users/"+e.id+"/favorites",function(e){n.$apply(s.resolve(e))})})):(SC.initialize({client_id:o.soundcloudClientId,redirect_uri:e}),SC.connect(function(){SC.get("/me",function(e){SC.get("/users/"+e.id+"/favorites",function(e){n.$apply(s.resolve(e))})})}))}),s.promise},t}]);