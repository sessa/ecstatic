angular.module("ecstatic.soundcloud").factory("soundcloudService",["$q","$rootScope","ConfigService","$location","$localStorage",function(e,n,o,i,c){var t={},s=e.defer();return t.getFavorites=function(){var e=i.absUrl().split("/")[0]+"//"+i.absUrl().split("/")[2]+"/api/soundcloud/callback";return SC.accessToken()&&(c.accessToken=SC.accessToken()),o.getConfig().then(function(o){c.accessToken?(SC.initialize({client_id:c.soundcloudClientId,redirect_uri:e,access_token:c.accessToken,scope:"non-expiring"}),SC.get("/me",function(e){SC.get("/users/"+e.id+"/favorites",function(e){n.$apply(s.resolve(e))})})):(SC.initialize({client_id:o.soundcloudClientId,redirect_uri:e}),SC.connect(function(){SC.get("/me",function(e){SC.get("/users/"+e.id+"/favorites",function(e){n.$apply(s.resolve(e))})})}))}),s.promise},t}]);